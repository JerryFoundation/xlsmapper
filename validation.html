<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-01-01 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Tatsuo TSUCHIE" />
    <meta name="Date-Creation-yyyymmdd" content="20141030" />
    <meta name="Date-Revision-yyyymmdd" content="20150101" />
    <meta http-equiv="Content-Language" content="ja" />
    <title>XlsMapper - 読み込んだ値の入力値検証</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>XlsMapper</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">最終更新: 2015-01-01
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">バージョン: 0.2.3
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">ドキュメント</li>
                              
      <li>
  
                          <a href="howtouse.html" title="基本的な使い方">
          <i class="none"></i>
        基本的な使い方</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>シートの値の入力値検証</a>
          </li>
                
      <li>
  
                          <a href="extension.html" title="拡張方法">
          <i class="none"></i>
        拡張方法</a>
            </li>
                
      <li>
  
                          <a href="diff_xlsbeans.html" title="XLSBeansとの違い">
          <i class="none"></i>
        XLSBeansとの違い</a>
            </li>
                
      <li>
  
                          <a href="download.html" title="ダウンロード">
          <i class="none"></i>
        ダウンロード</a>
            </li>
                
      <li>
  
                          <a href="release.html" title="リリースノート">
          <i class="none"></i>
        リリースノート</a>
            </li>
                
      <li>
  
                          <a href="apidocs/index.html" title="Javadoc">
          <i class="none"></i>
        Javadoc</a>
            </li>
                              <li class="nav-header">プロジェクト文書</li>
                                                                                                                                                                                                                                                                                                        
      <li>
  
                          <a href="project-info.html" title="プロジェクト情報">
          <i class="icon-chevron-right"></i>
        プロジェクト情報</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="project-reports.html" title="プロジェクトレポート">
          <i class="icon-chevron-right"></i>
        プロジェクトレポート</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>&#x8aad;&#x307f;&#x8fbc;&#x3093;&#x3060;&#x5024;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;<a name="a"></a></h2>
<ul>
<li><a href="#a">&#x8aad;&#x307f;&#x8fbc;&#x3093;&#x3060;&#x5024;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a>
<ul>
<li><a href="#a">&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;&#x306e;&#x57fa;&#x672c;</a></li>
<li><a href="#a">&#x72ec;&#x81ea;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a>
<ul>
<li><a href="#a">&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#xff08;&#x30d7;&#x30ed;&#x30d1;&#x30c6;&#x30a3;&#xff09;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a></li>
<li><a href="#a">&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306e;&#x5b9a;&#x7fa9;</a></li>
<li><a href="#a">&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306e;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x65b9;&#x6cd5;&#x306e;&#x5909;&#x66f4;</a></li>
<li><a href="#EL">EL&#x5f0f;&#x306e;&#x30ab;&#x30b9;&#x30bf;&#x30de;&#x30a4;&#x30ba;</a></li></ul></li>
<li><a href="#Bean_Validation">Bean Validation&#x3092;&#x4f7f;&#x7528;&#x3057;&#x305f;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a></li></ul></li></ul>
<div class="section">
<h3><a name="a">&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;&#x306e;&#x57fa;&#x672c;</a><a name="a"></a></h3>
<p>XlsMapper&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;&#x306f;&#x3001;SpringFramework&#x306e;Validation&#x6a5f;&#x69cb;&#x306b;&#x4f3c;&#x305f;&#x65b9;&#x6cd5;&#x3092;&#x3068;&#x308a;&#x307e;&#x3059;&#x3002;</p>
<ul>
<li>&#x30a8;&#x30e9;&#x30fc;&#x60c5;&#x5831;&#x306f;&#x3001;SheetBindingErrors&#x30af;&#x30e9;&#x30b9;&#x306b;&#x683c;&#x7d0d;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>SheetBindingErrors&#x306e;&#x30a4;&#x30f3;&#x30b9;&#x30bf;&#x30f3;&#x30b9;&#x3092;&#x3001;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x6642;&#x306b;&#x5f15;&#x6570;&#x3068;&#x3057;&#x3066;&#x6e21;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30bb;&#x30eb;&#x306e;&#x5024;&#x3092;Java&#x30aa;&#x30d6;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x306b;&#x5909;&#x63db;&#x306e;&#x5931;&#x6557;&#x60c5;&#x5831;&#x306f;&#x3001;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x6642;&#x306b;&#x81ea;&#x52d5;&#x7684;&#x306b;&#x4f5c;&#x6210;&#x3055;&#x308c;&#x307e;&#x3059;&#x3002;
<ul>
<li>1&#x3064;&#x306e;&#x30bb;&#x30eb;&#x306e;&#x578b;&#x5909;&#x63db;&#x306b;&#x5931;&#x6557;&#x3057;&#x3066;&#x3082;&#x51e6;&#x7406;&#x3092;&#x7d9a;&#x884c;&#x3059;&#x308b;&#x3088;&#x3046;&#x3001;&#x30b7;&#x30b9;&#x30c6;&#x30e0;&#x8a2d;&#x5b9a;XlsMapperConfig&#x306e;&#x9805;&#x76ee;&#x300c;skipTypeBindFailure&#x300d;&#x3092;'true'&#x306b;&#x8a2d;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x5225;&#x9014;&#x7528;&#x610f;&#x3057;&#x305f;Bean&#x306b;&#x5bfe;&#x3059;&#x308b;Validator&#x306b;&#x3088;&#x308a;&#x3001;&#x5024;&#x3092;&#x691c;&#x8a3c;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>&#x901a;&#x5e38;&#x306f;&#x3001;&#x62bd;&#x8c61;&#x30af;&#x30e9;&#x30b9;&#x300c;AbstractObjectValidator&#x300d;&#x3092;&#x7d99;&#x627f;&#x3057;&#x3066;&#x4f5c;&#x6210;&#x3057;&#x307e;&#x3059;&#x3002;</li>
<li>@XlsHorizontalRecords&#x306e;&#x3088;&#x3046;&#x306b;&#x30cd;&#x30b9;&#x30c8;&#x3057;&#x305f;Bean&#x306e;&#x5834;&#x5408;&#x3001;&#x30ea;&#x30b9;&#x30c8;&#x306e;&#x8981;&#x7d20;&#x306e;Bean&#x306e;Validator&#x3092;&#x5225;&#x9014;&#x7528;&#x610f;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x3042;&#x308b;&#x5834;&#x5408;&#x3001;SheetMessageConverter&#x3092;&#x4f7f;&#x7528;&#x3057;&#x3066;&#x3001;&#x30a8;&#x30e9;&#x30fc;&#x30aa;&#x30d6;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x3092;&#x6587;&#x5b57;&#x5217;&#x306b;&#x5909;&#x63db;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul>
<div>
<pre>XlsMapper xlsMapper = new XlsMapper();

// &#x578b;&#x5909;&#x63db;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x8d77;&#x304d;&#x3066;&#x3082;&#x51e6;&#x7406;&#x3092;&#x7d9a;&#x884c;&#x3059;&#x308b;&#x3088;&#x3046;&#x8a2d;&#x5b9a;
xlsMapper.getConig().setSkipTypeBindFailure(true);

// &#x30a8;&#x30e9;&#x30fc;&#x60c5;&#x5831;&#x306e;&#x7ba1;&#x7406;&#x30af;&#x30e9;&#x30b9;&#x306e;&#x30a4;&#x30f3;&#x30b9;&#x30bf;&#x30f3;&#x30b9;&#x306e;&#x4f5c;&#x6210;&#x3002;&#x30aa;&#x30d6;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x540d;&#x3092;&#x30af;&#x30e9;&#x30b9;&#x540d;&#x306b;&#x8a2d;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;
SheetBindingErrors errors = new SheetBindingErrors(Employer.class);

// &#x30a8;&#x30e9;&#x30fc;&#x60c5;&#x5831;&#x3092;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x6642;&#x306b;&#x6e21;&#x3057;&#x3001;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x51e6;&#x7406;&#x3092;&#x5b9f;&#x884c;&#x3057;&#x307e;&#x3059;&#x3002;
Employer bean = xlsMapper.load(xlsIn, Employer.class, errors);

// Bean&#x306e;Validator&#x3092;&#x5b9f;&#x884c;&#x3057;&#x307e;&#x3059;&#x3002;
EmployerValidator validator = new EmployerValidator();
validator.validate(bean, errors);

// &#x5024;&#x306e;&#x691c;&#x8a3c;&#x7d50;&#x679c;&#x3092;&#x6587;&#x5b57;&#x5217;&#x306b;&#x5909;&#x63db;&#x3057;&#x307e;&#x3059;&#x3002;
if(errors.hasErrors()) {
    SheetMessageConverter messageConverter = new SheetMessageConverter();
    for(ObjectError error : errors.getAllErrors()) {
        String message = messageConverter.convertMessage(error);
    }
}
</pre></div></div>
<div class="section">
<h3><a name="a">&#x72ec;&#x81ea;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a><a name="a"></a></h3>
<p>Validator&#x306f;&#x3001;AbstractObjectValidator&#x3092;&#x7d99;&#x627f;&#x3057;&#x3066;&#x4f5c;&#x6210;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<ul>
<li>Generics&#x3067;&#x691c;&#x8a3c;&#x5bfe;&#x8c61;&#x306e;Bean&#x30af;&#x30e9;&#x30b9;&#x3092;&#x6307;&#x5b9a;&#x3057;&#x3001;validate&#x30e1;&#x30bd;&#x30c3;&#x30c9;&#x5185;&#x3067;&#x691c;&#x8a3c;&#x51e6;&#x7406;&#x306e;&#x5b9f;&#x88c5;&#x3092;&#x884c;&#x3044;&#x307e;&#x3059;&#x3002;</li>
<li>&#x691c;&#x8a3c;&#x5bfe;&#x8c61;&#x306e;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306b;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x3042;&#x308b;&#x304b;&#x3069;&#x3046;&#x304b;&#x306f;&#x3001;SheetBindingErrors#hasFieldErrors&#x3067;&#x30c1;&#x30a7;&#x30c3;&#x30af;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;
<ul>
<li>&#x578b;&#x5909;&#x63db;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x3042;&#x308b;&#x5834;&#x5408;&#x3001;Bean&#x306b;&#x5024;&#x304c;&#x30de;&#x30c3;&#x30d4;&#x30f3;&#x30b0;&#x3055;&#x308c;&#x3066;&#x3044;&#x306a;&#x3044;&#x305f;&#x3081;&#x3001;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x3042;&#x308b;&#x304b;&#x3069;&#x3046;&#x304b;&#x3092;&#x30c1;&#x30a7;&#x30c3;&#x30af;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306b;&#x5bfe;&#x3059;&#x308b;&#x30a8;&#x30e9;&#x30fc;&#x3092;&#x8a2d;&#x5b9a;&#x3059;&#x308b;&#x5834;&#x5408;&#x3001;SheetBindingErrors#rejectValue(&quot;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&quot;, &quot;&#x30a8;&#x30e9;&#x30fc;&#x30b3;&#x30fc;&#x30c9;&quot;, &quot;&#x30a8;&#x30e9;&#x30fc;&#x5f15;&#x6570;&quot;)&#x3067;&#x8a2d;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>Map&lt;String, Points&gt;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x3067;&#x30bb;&#x30eb;&#x306e;&#x30a2;&#x30c9;&#x30ec;&#x30b9;&#x3092;&#x4fdd;&#x6301;&#x3057;&#x3066;&#x3044;&#x308b;&#x5834;&#x5408;&#x306f;&#x3001;SheetBindingErrors#rejectSheetValue(...)&#x3067;&#x30bb;&#x30eb;&#x306e;&#x30a2;&#x30c9;&#x30ec;&#x30b9;&#x3092;&#x6307;&#x5b9a;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</li>
<li>&#x30a8;&#x30e9;&#x30fc;&#x5f15;&#x6570;&#x306f;&#x3001;&#x30a4;&#x30f3;&#x30c7;&#x30c3;&#x30af;&#x30b9;&#x5f62;&#x5f0f;&#x306e;&#x914d;&#x5217;&#x578b;&#x3068;&#x540d;&#x524d;&#x4ed8;&#x304d;&#x306e;&#x30de;&#x30c3;&#x30d7;&#x578b;&#x306e;&#x3069;&#x3061;&#x3089;&#x3067;&#x3082;&#x6307;&#x5b9a;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;&#x540d;&#x524d;&#x4ed8;&#x304d;&#x306e;&#x30de;&#x30c3;&#x30d7;&#x578b;&#x306e;&#x5229;&#x7528;&#x3092;&#x304a;&#x52e7;&#x3081;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li></ul>
<div>
<pre>public class EmployerValidator extends AbstractObjectValidator&lt;Employer&gt;{
    
    // &#x30cd;&#x30b9;&#x30c8;&#x3057;&#x305f;Bean&#x306e;Validator
    private EmployerHistoryValidator historyValidator;
    
    public EmployerValidator() {
        this.historyValidator = new EmployerHistoryValidator();
    }
    
    @Override
    public void validate(final Employer targetObj, final SheetBindingErrors errors) {
        
        // &#x578b;&#x5909;&#x63db;&#x306a;&#x3069;&#x306e;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x306a;&#x3044;&#x5834;&#x5408;&#x3001;&#x6587;&#x5b57;&#x9577;&#x306e;&#x30c1;&#x30a7;&#x30c3;&#x30af;&#x3092;&#x884c;&#x3046;
        // &#x30c1;&#x30a7;&#x30c3;&#x30af;&#x5bfe;&#x8c61;&#x306e;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&#x3092;&#x6307;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;
        if(!errors.hasFieldErrors(&quot;name&quot;)) {
            if(targetObj.getName().length() &gt; 10) {
                // &#x30a4;&#x30f3;&#x30c7;&#x30c3;&#x30af;&#x30b9;&#x5f62;&#x5f0f;&#x306e;&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x5f15;&#x6570;&#x306e;&#x6307;&#x5b9a;
                //errors.rejectValue(&quot;name&quot;, &quot;error.maxLength&quot;, new Object[]{10});
                
                // &#x540d;&#x524d;&#x4ed8;&#x304d;&#x306e;&#x5f15;&#x6570;&#x3001;&#x30bb;&#x30eb;&#x306e;&#x30a2;&#x30c9;&#x30ec;&#x30b9;&#x3092;&#x6e21;&#x3059;&#x5834;&#x5408;&#x306e;&#x6307;&#x5b9a;
                Map&lt;String, Object&gt; vars = new HashMap&lt;&gt;();
                Point address = targetObj.positions(&quot;name&quot;);
                errors.rejectSheetValue(&quot;name&quot;, address, &quot;error.maxLength&quot;, vars);
            }
        }
        
        for(int i=0; i &lt; targetObj.getHistory().size(); i++) {
            // &#x30cd;&#x30b9;&#x30c8;&#x3057;&#x305f;Bean&#x306e;&#x691c;&#x8a3c;&#x306e;&#x5b9f;&#x884c;
            // &#x30d1;&#x30b9;&#x3092;&#x30cd;&#x30b9;&#x30c8;&#x3059;&#x308b;&#x3002;&#x30ea;&#x30b9;&#x30c8;&#x306e;&#x5834;&#x5408;&#x306f;&#x30a4;&#x30f3;&#x30c7;&#x30c3;&#x30af;&#x30b9;&#x3092;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x3002;
            errors.pushNestedPath(&quot;history&quot;, i);
            historyValidator.validate(targetObj.getHistory().get(i), errors);
            // &#x691c;&#x8a3c;&#x5f8c;&#x306f;&#x3001;&#x30d1;&#x30b9;&#x3092;&#x623b;&#x3059;
            errors.popNestedPath();
            
            // &#x30d1;&#x30b9;&#x306e;&#x30cd;&#x30b9;&#x30c8;&#x3068;&#x623b;&#x3057;&#x306f;&#x3001;invokeNestedValidator&#x3067;&#x81ea;&#x52d5;&#x7684;&#x306b;&#x3082;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;
            // invokeNestedValidator(historyValidator, targetObj.getHistory().get(i), errors, &quot;history&quot;, i);
        }
        
    }
}
</pre></div>
<div class="section">
<h4><a name="a">&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#xff08;&#x30d7;&#x30ed;&#x30d1;&#x30c6;&#x30a3;&#xff09;&#x306e;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a><a name="a"></a></h4>
<p>&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306b;&#x5bfe;&#x3059;&#x308b;&#x5024;&#x306e;&#x691c;&#x8a3c;&#x306f;&#x3001;CellField&#x30af;&#x30e9;&#x30b9;&#x3092;&#x4f7f;&#x7528;&#x3059;&#x308b;&#x3053;&#x3068;&#x3067;&#x3082;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>
<ul>
<li>&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306b;&#x5bfe;&#x3059;&#x308b;&#x691c;&#x8a3c;&#x3092;CellField#add(...)&#x3067;&#x8ffd;&#x52a0;&#x3059;&#x308b;&#x3053;&#x3068;&#x3067;&#x8907;&#x6570;&#x306e;&#x691c;&#x8a3c;&#x3092;&#x8a2d;&#x5b9a;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</li>
<li>&#x5024;&#x306e;&#x4ef6;&#x6240;&#x3092;&#x884c;&#x3046;&#x5834;&#x5408;&#x306f;&#x3001;CellField#validate(errors)&#x3067;&#x5b9f;&#x884c;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>SheetBindingErrors&#x306b;&#x5bfe;&#x3057;&#x3066;&#x30a8;&#x30e9;&#x30fc;&#x30aa;&#x30d6;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x304c;&#x81ea;&#x52d5;&#x7684;&#x306b;&#x8a2d;&#x5b9a;&#x3055;&#x308c;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306b;&#x5bfe;&#x3057;&#x3066;&#x30a8;&#x30e9;&#x30fc;&#x304c;&#x3042;&#x308b;&#x5834;&#x5408;&#x3001;CellField#hasErrors(...)/hasNotErrors(...)&#x3067;&#x691c;&#x8a3c;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</li></ul>
<div>
<pre>public class EmployerHistoryValidator extends AbstractObjectValidator&lt;EmployerHistory&gt;{
    
    @Override
    public void validate(final EmployerHistory targetObj, final SheetBindingErrors errors) {
        
        final CellField&lt;Date&gt; historyDateField = new CellField&lt;Date&gt;(targetObj, &quot;historyDate&quot;);
        historyDateField.setRequired(true)
            .add(new MinValidator&lt;Date&gt;(new Date(), &quot;yyyy-MM-dd&quot;))
            .validate(errors);
        
        
        final CellField&lt;String&gt; commentField = new CellField&lt;String&gt;(targetObj, &quot;comment&quot;);
        commentField.setRequired(false)
            .add(StringValidator.maxLength(5))
            .validate(errors);
        
        if(historyDateField.hasNotErrors(errors) &amp;&amp; commentField.hasNotErrors(errors)) {
            // &#x9805;&#x76ee;&#x9593;&#x306e;&#x30c1;&#x30a7;&#x30c3;&#x30af;&#x306a;&#x3069;
            if(commentField.isInputEmpty()) {
                errors.reject(&quot;error.01&quot;);
            }
        }
        
    }
}
</pre></div></div>
<div class="section">
<h4><a name="a">&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306e;&#x5b9a;&#x7fa9;</a><a name="a"></a></h4>
<p>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306f;&#x3001;&#x30af;&#x30e9;&#x30b9;&#x30d1;&#x30b9;&#x306e;&#x30eb;&#x30fc;&#x30c8;&#x306b;&#x300c;SheetValidationMessages.properties&#x300d;&#x3068;&#x3044;&#x3046;&#x30d7;&#x30ed;&#x30d1;&#x30c6;&#x30a3;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x3092;&#x914d;&#x7f6e;&#x3057;&#x3066;&#x304a;&#x304f;&#x3068;&#x3001; &#x81ea;&#x52d5;&#x7684;&#x306b;&#x8aad;&#x307f;&#x8fbc;&#x307e;&#x308c;&#x307e;&#x3059;&#x3002;</p>
<ul>
<li>&#x578b;&#x5909;&#x63db;&#x30a8;&#x30e9;&#x30fc;&#x306f;&#x3001;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x6642;&#x306b;&#x81ea;&#x52d5;&#x7684;&#x306b;&#x30c1;&#x30a7;&#x30c3;&#x30af;&#x3055;&#x308c;&#x3001;&#x30a8;&#x30e9;&#x30fc;&#x30b3;&#x30fc;&#x30c9;&#x306f;&#x3001;&#x300c;cellTypeMismatch&#x300d;&#x3068;&#x6c7a;&#x307e;&#x3063;&#x3066;&#x3044;&#x307e;&#x3059;&#x3002;
<ul>
<li>&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306e;&#x30af;&#x30e9;&#x30b9;&#x30bf;&#x30a4;&#x30d7;&#x3054;&#x3068;&#x306b;&#x3001;&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x3092;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x3053;&#x3068;&#x3082;&#x3067;&#x304d;&#x3001;&#x300c;cellTypeMismatch.&lt;&#x30af;&#x30e9;&#x30b9;&#x540d;&gt;&#x300d;&#x3067;&#x5b9a;&#x7fa9;&#x3057;&#x307e;&#x3059;&#x3002;</li>
<li>&#x3055;&#x3089;&#x306b;&#x3001;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&#x3067;&#x3082;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x3053;&#x3068;&#x304c;&#x3067;&#x304d;&#x3001;&#x300c;cellTypeMismatch.&lt;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&gt;&#x300d;&#x3067;&#x5b9a;&#x7fa9;&#x3057;&#x307e;&#x3059;&#x3002;</li>
<li>&#x30af;&#x30e9;&#x30b9;&#x30bf;&#x30a4;&#x30d7;&#x3088;&#x308a;&#x3082;&#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&#x3067;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x65b9;&#x304c;&#x512a;&#x5148;&#x3055;&#x308c;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x4e2d;&#x3067;&#x306f;EL&#x5f0f;&#x3092;&#x5229;&#x7528;&#x3059;&#x308b;&#x3053;&#x3068;&#x304c;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;
<ul>
<li>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x4e2d;&#x306e;&#x901a;&#x5e38;&#x306e;&#x5909;&#x6570;&#x306f;&#x3001;{&#x5909;&#x6570;&#x540d;}&#x3067;&#x5b9a;&#x7fa9;&#x3057;&#x3001;EL&#x5f0f;&#x306f;${EL&#x5f0f;}&#x3067;&#x5b9a;&#x7fa9;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>&#x305f;&#x3060;&#x3057;&#x3001;EL&#x5f0f;&#x306e;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x3092;&#x4f9d;&#x5b58;&#x95a2;&#x4fc2;&#x306b;&#x8ffd;&#x52a0;&#x3057;&#x3066;&#x304a;&#x304f;&#x5fc5;&#x8981;&#x304c;&#x3042;&#x308a;&#x307e;&#x3059;&#x3002;</li></ul></li></ul>
<div>
<pre>## &#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x306e;&#x5b9a;&#x7fa9;
## SheetValidationMessages.properties

# &#x5171;&#x901a;&#x5909;&#x6570;
# {sheetName} : &#x30b7;&#x30fc;&#x30c8;&#x540d;
# {cellAddress} : &#x30bb;&#x30eb;&#x306e;&#x30a2;&#x30c9;&#x30ec;&#x30b9;&#x3002;'A1'&#x306a;&#x3069;&#x306e;&#x5f62;&#x5f0f;&#x3002;
# {label} : &#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x306e;&#x898b;&#x51fa;&#x3057;&#x3002;

# &#x578b;&#x5909;&#x63db;&#x30a8;&#x30e9;&#x30fc;
cellTypeMismatch=[{sheetName}]:${empty label ? '' : label} - {cellAddress}&#x306e;&#x578b;&#x5909;&#x63db;&#x306b;&#x5931;&#x6557;&#x3057;&#x307e;&#x3057;&#x305f;&#x3002;

# &#x30af;&#x30e9;&#x30b9;&#x30bf;&#x30a4;&#x30d7;&#x3067;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x5834;&#x5408;
cellTypeMismatch.int=[{sheetName}]:${empty label ? '' : label} - {cellAddress}&#x306f;&#x6570;&#x5024;&#x578b;&#x3067;&#x6307;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;
cellTypeMismatch.java.util.Date=[{sheetName}]:${empty label ? '' : label} - {cellAddress}&#x306f;&#x65e5;&#x4ed8;&#x578b;&#x3067;&#x6307;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;

# &#x30d5;&#x30a3;&#x30fc;&#x30eb;&#x30c9;&#x540d;&#x3067;&#x6307;&#x5b9a;&#x3059;&#x308b;&#x5834;&#x5408;
cellTypeMismatch.updateTime=[{sheetName}]:${empty label ? '' : label} - {cellAddress}&#x306f;'yyyy/MM/dd'&#x306e;&#x66f8;&#x5f0f;&#x3067;&#x6307;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;
</pre></div></li></ul></div>
<div class="section">
<h4><a name="a">&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306e;&#x8aad;&#x307f;&#x8fbc;&#x307f;&#x65b9;&#x6cd5;&#x306e;&#x5909;&#x66f4;</a><a name="a"></a></h4>
<p>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x30d5;&#x30a1;&#x30a4;&#x30eb;&#x306f;&#x3001;ResourceBundle&#x3084;Properties&#x3001;&#x307e;&#x305f;Spring&#x306e;MessageSource&#x304b;&#x3089;&#x3082;&#x53d6;&#x5f97;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>
<p>&#x8a2d;&#x5b9a;&#x3059;&#x308b;&#x5834;&#x5408;&#x3001;SheetMessageConverter#setMessageResolver(...)&#x3067;&#x5bfe;&#x5fdc;&#x3059;&#x308b;&#x30af;&#x30e9;&#x30b9;&#x3092;&#x8a2d;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<table border="0" class="table table-striped">
<tr class="a">
<td align="left">XlsMapper&#x63d0;&#x4f9b;&#x306e;&#x30af;&#x30e9;&#x30b9;</td>
<td align="left">&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x53d6;&#x5f97;&#x5143;&#x306e;&#x30af;&#x30e9;&#x30b9;</td></tr>
<tr class="b">
<td align="left">com.gh.mygreen.xlsmapper.validation.ResourceBundleMessageResolver</td>
<td align="left">java.util.ResourceBundle</td></tr>
<tr class="a">
<td align="left">com.gh.mygreen.xlsmapper.validation.PropertiesMessageResolver</td>
<td align="left">java.util.Prperties</td></tr>
<tr class="b">
<td align="left">com.gh.mygreen.xlsmapper.validation.SpringMessageResolver</td>
<td align="left">org.springframework.context.MessageSource</td></tr></table>
<div>
<pre>// Spring&#x306e;MessageSource&#x304b;&#x3089;&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x3092;&#x53d6;&#x5f97;&#x3059;&#x308b;&#x5834;&#x5408;
MessageSource messageSource = /*...*/;

SheetMessageConverter messageConverter = new SheetMessageConverter();
messageConverter.setMessageResolver(new SpringMessageResolver(messageSource));
</pre></div></div>
<div class="section">
<h4><a name="EL">EL&#x5f0f;&#x306e;&#x30ab;&#x30b9;&#x30bf;&#x30de;&#x30a4;&#x30ba;</a><a name="EL"></a></h4>
<p>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x4e2d;&#x306e;&#x5f0f;&#x8a00;&#x8a9e;&#x306f;&#x3001;EL&#x5f0f;&#x4ee5;&#x5916;&#x3082;&#x5229;&#x7528;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>
<p>EL&#x5f0f;&#x306e;&#x4ed6;&#x3001;MVEL&#x3001;OGNL&#x3001;SpEL(Spring Expresson Language)&#x304c;&#x5229;&#x7528;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>
<p>&#x4f7f;&#x7528;&#x3059;&#x308b;&#x5f0f;&#x8a00;&#x8a9e;&#x3092;&#x5909;&#x66f4;&#x3059;&#x308b;&#x5834;&#x5408;&#x3001;MessageInterapolator#setExpressionLanguage(...)&#x3067;&#x5f0f;&#x8a00;&#x8a9e;&#x306e;&#x5b9f;&#x88c5;&#x3092;&#x8a2d;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<p>MVEL&#x3084;SpEL&#x3092;&#x5229;&#x7528;&#x3059;&#x308b;&#x5834;&#x5408;&#x3001;&#x5225;&#x9014;&#x3001;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x304c;&#x5fc5;&#x8981;&#x306b;&#x306a;&#x308a;&#x307e;&#x3059;&#x3002;</p>
<div>
<pre>
SheetMessageConverter messageConverter = new SheetMessageConverter();

// EL&#x5f0f;&#x306e;&#x7ba1;&#x7406;&#x30af;&#x30e9;&#x30b9;&#x306e;&#x4f5c;&#x6210;
ExpressionLanguageRegistry elRegistry = new ExpressionLanguageRegistry();

// &#x5f0f;&#x8a00;&#x8a9e;&#x306e;&#x8a2d;&#x5b9a;
messageConverter.getMessageInterporlator()
    .setExpressionLanguage(elRegistry.getExpressionLanguage(&quot;mvel&quot;));
</pre></div>
<dl>
<dt>Note</dt>
<dd>&#x5f0f;&#x8a00;&#x8a9e;&#x3092;&#x5909;&#x66f4;&#x3057;&#x305f;&#x5834;&#x5408;&#x3001;&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x4e2d;&#x306e;$<a name="EL">EL&#x5f0f;</a>&#x3092;&#x3001;&#x8a00;&#x8a9e;&#x7279;&#x6709;&#x306e;&#x3082;&#x306e;&#x306b;&#x5909;&#x66f4;&#x3059;&#x308b;&#x5fc5;&#x8981;&#x304c;&#x3042;&#x308a;&#x307e;&#x3059;&#x3002;
<div>
<pre>&lt;!-- ====================== &#x5404;&#x5f0f;&#x8a00;&#x8a9e;&#x306e;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea; ===============--&gt;
&lt;!-- EL&#x5f0f;&#x3092;&#x5229;&#x7528;&#x3059;&#x308b;&#x5834;&#x5408; --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.el&lt;/groupId&gt;
    &lt;artifactId&gt;javax.el-api&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish&lt;/groupId&gt;
    &lt;artifactId&gt;javax.el&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;

&lt;!-- &#x5f0f;&#x8a00;&#x8a9e;:OGNL --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;ognl&lt;/groupId&gt;
    &lt;artifactId&gt;ognl&lt;/artifactId&gt;
    &lt;version&gt;3.0.8&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- &#x5f0f;&#x8a00;&#x8a9e;:MVEL --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mvel&lt;/groupId&gt;
    &lt;artifactId&gt;mvel2&lt;/artifactId&gt;
    &lt;version&gt;2.2.2.Final&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- &#x5f0f;&#x8a00;&#x8a9e;&#xff1a;Spring Expression Language --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;
    &lt;version&gt;3.2.11.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></dd></dl></div></div>
<div class="section">
<h3><a name="Bean_Validation">Bean Validation&#x3092;&#x4f7f;&#x7528;&#x3057;&#x305f;&#x5165;&#x529b;&#x5024;&#x691c;&#x8a3c;</a><a name="Bean_Validation"></a></h3>
<p>BeanValidation JSR-303(ver.1.0)/JSR-349(ver.1.1)&#x3092;&#x5229;&#x7528;&#x3059;&#x308b;&#x5834;&#x5408;&#x3001;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x3067;&#x7528;&#x610f;&#x3055;&#x308c;&#x3066;&#x3044;&#x308b;&#x300c;SheetBeanValidator&#x300d;&#x3092;&#x4f7f;&#x7528;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<ul>
<li>BeanValidation&#x306e;&#x5b9f;&#x88c5;&#x3068;&#x3057;&#x3066;&#x3001;Hibernate Validator&#x304c;&#x5fc5;&#x8981;&#x306b;&#x306a;&#x308b;&#x305f;&#x3081;&#x3001;&#x4f9d;&#x5b58;&#x95a2;&#x4fc2;&#x306b;&#x8ffd;&#x52a0;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>Hibernate Validator&#x3092;&#x5229;&#x7528;&#x3059;&#x308b;&#x305f;&#x3081;&#x3001;&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x3092;&#x30ab;&#x30b9;&#x30bf;&#x30de;&#x30a4;&#x30ba;&#x3057;&#x305f;&#x3044;&#x5834;&#x5408;&#x306f;&#x3001;&#x30af;&#x30e9;&#x30b9;&#x30d1;&#x30b9;&#x306e;&#x30eb;&#x30fc;&#x30c8;&#x306b;&#x300c;ValidationMessages.properties&#x300d;&#x3092;&#x914d;&#x7f6e;&#x3057;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x691c;&#x8a3c;&#x3059;&#x308b;&#x969b;&#x306b;&#x306f;&#x3001;SheetBeanValidator#validate(...)&#x3092;&#x5b9f;&#x884c;&#x3057;&#x307e;&#x3059;&#x3002;
<ul>
<li>Bean Validation&#x306e;&#x691c;&#x8a3c;&#x7d50;&#x679c;&#x3082;&#x3001;SheetBindingErrors&#x306e;&#x5f62;&#x5f0f;&#x306b;&#x5909;&#x63db;&#x3055;&#x308c;&#x683c;&#x7d0d;&#x3055;&#x308c;&#x307e;&#x3059;&#x3002;</li></ul></li>
<li>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x6642;&#x3092;&#x51fa;&#x529b;&#x3059;&#x308b;&#x5834;&#x5408;&#x306f;&#x3001;SheetMessageConverter&#x3092;&#x4f7f;&#x7528;&#x3057;&#x307e;&#x3059;&#x3002;
<div>
<pre>// &#x30b7;&#x30fc;&#x30c8;&#x306e;&#x8aad;&#x307f;&#x8fbc;&#x307f;
SheetBindingErrors errors = new SheetBindingErrors(Employer.class);
Employer beanObj = loadSheet(new File(&quot;./src/test/data/employer.xlsx&quot;), errors);

// Bean Validation&#x306b;&#x3088;&#x308b;&#x691c;&#x8a3c;&#x306e;&#x5b9f;&#x884c;
SheetBeanValidator validatorAdaptor = new SheetBeanValidator(validator);
validatorAdaptor.validate(beanObj, errors);

// &#x5024;&#x306e;&#x691c;&#x8a3c;&#x7d50;&#x679c;&#x3092;&#x6587;&#x5b57;&#x5217;&#x306b;&#x5909;&#x63db;&#x3057;&#x307e;&#x3059;&#x3002;
if(errors.hasErrors()) {
    SheetMessageConverter messageConverter = new SheetMessageConverter();
    for(ObjectError error : errors.getAllErrors()) {
        String message = messageConverter.convertMessage(error);
    }
}
</pre></div>
<div>
<pre>&lt;!-- ====================== Bean Validation&#x306e;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea; ===============--&gt;
&lt;!-- Bean Validation 1.1 &#x7cfb;&#x3092;&#x5229;&#x7528;&#x3059;&#x308b; --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.validation&lt;/groupId&gt;
    &lt;artifactId&gt;validation-api&lt;/artifactId&gt;
    &lt;version&gt;1.1.0.Final&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;version&gt;5.1.3.Final&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</pre></div></li></ul></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2015
                        <a href="http://mygreen.github.io/xlsmapper/">mygreen</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
